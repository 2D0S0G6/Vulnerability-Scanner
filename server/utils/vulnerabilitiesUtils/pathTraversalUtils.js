const { curlRequest } = require('../curlUtils');
const pathTraversalPayloads = require('../../payloads/pathTraversal');
const paramsPayloads = require('../../payloads/params');

// To check path traversal
async function pathTraversal(targetURL) {
    for (param in paramsPayloads) {
        for (const payload of pathTraversalPayloads) {
            const url = `${targetURL}?${param}=${payload}`;
            // For testing sake logging the URL
            console.log(`Testing URL: ${url}`);
            try {
                const response = await curlRequest(url);
                console.log(`Response: ${response.response}`);
            } catch (error) {
                console.error(`Error sending request: ${error}`);
            }
        }
    }
}

module.exports = {
    pathTraversal
};