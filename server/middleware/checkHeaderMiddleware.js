// Check for a specific header
function checkHeader(headerName, expectedValue) {
    return function(req, res, next) {
        if (req.headers[headerName]) {
            // Check for the value too, yet too implement the values
            if (req.headers[headerName] === expectedValue) {
                next();
            } else {
                res.status(403).json({ error: `Invalid value for header '${headerName}'` });
            }
        } else {
            res.status(400).json({ error: `Header '${headerName}' is missing` });
        }
    };
}

module.exports = {
    checkHeader
}